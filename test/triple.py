##########################################################################
# Copyright (c) 2025 Reinhard Caspary                                    #
# <reinhard.caspary@phoenixd.uni-hannover.de>                            #
# This program is free software under the terms of the MIT license.      #
##########################################################################
#
# Matrix elements for 2nd order Coulomb interactions described by
# three-electron tensor operators (H4) for the f3 configuration.
#
##########################################################################

import math

SOURCES = {
    "[34]": {
        "authors": ["B. R. Judd"],
        "title": "Three-Particle Operators for Equivalent Electrons",
        "journal": "Physical Review",
        "volume": "141",
        "number": 1,
        "pages": "4-14",
        "year": "1966",
        "doi": "https://doi.org/10.1103/PhysRev.141.4"
    },
}

STATES = {
    3: {
        "4S(111)[00]": "4S",
        "2P(210)[11]": "2P",
        "2D(210)[20]": "2D1",
        "2D(210)[21]": "2D2",
        "2F(100)[10]": "2F1",
        "2F(210)[21]": "2F2",
        "2G(210)[20]": "2G1",
        "2G(210)[21]": "2G2",
        "2H(210)[11]": "2H1",
        "2H(210)[21]": "2H2",
        "2I(210)[20]": "2I",
        "2K(210)[21]": "2K",
        "2L(210)[21]": "2L",
        "4D(111)[20]": "4D",
        "4F(111)[10]": "4F",
        "4G(111)[20]": "4G",
        "4I(111)[20]": "4I",
    }
}

TRIPLE = {
    "Nd3+|H4/1": {
        "num": 3,
        "name": "H4/1",
        "factor": math.sqrt(33 / 6860),
        "elements": {
            "4S 4S": 6,
            "4D 4D": 6,
            "4F 4F": 6,
            "4G 4G": 6,
            "4I 4I": 6,
            "2P 2P": -1,
            "2D1 2D1": -1,
            "2D1 2D2": 0,
            "2D2 2D2": -1,
            "2F1 2F1": -15,
            "2F1 2F2": 0,
            "2F2 2F2": -1,
            "2G1 2G1": -1,
            "2G1 2G2": 0,
            "2G2 2G2": -1,
            "2H1 2H1": -1,
            "2H1 2H2": 0,
            "2H2 2H2": -1,
            "2I 2I": -1,
            "2K 2K": -1,
            "2L 2L": -1,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/2": {
        "num": 3,
        "name": "H4/2",
        "factor": math.sqrt(2) / 2156,
        "elements": {
            "4S 4S": 0,
            "4D 4D": 1694,
            "4F 4F": 0,
            "4G 4G": 616,
            "4I 4I": -1078,
            "2P 2P": -385,
            "2D1 2D1": -319,
            "2D1 2D2": 36 * math.sqrt(33),
            "2D2 2D2": -423,
            "2F1 2F1": 0,
            "2F1 2F2": 231 * math.sqrt(22),
            "2F2 2F2": -21,
            "2G1 2G1": -116,
            "2G1 2G2": 3 * math.sqrt(4290),
            "2G2 2G2": 11,
            "2H1 2H1": 105,
            "2H1 2H2": 0,
            "2H2 2H2": -399,
            "2I 2I": 203,
            "2K 2K": 56,
            "2L 2L": 336,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/3": {
        "num": 3,
        "name": "H4/3",
        "factor": 1 / math.sqrt(6720),
        "elements": {
            "4S 4S": 288,
            "4D 4D": 8,
            "4F 4F": -72,
            "4G 4G": 8,
            "4I 4I": 8,
            "2P 2P": -48,
            "2D1 2D1": 32,
            "2D1 2D2": 0,
            "2D2 2D2": -3,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": -3,
            "2G1 2G1": 32,
            "2G1 2G2": 0,
            "2G2 2G2": -3,
            "2H1 2H1": -48,
            "2H1 2H2": 0,
            "2H2 2H2": -3,
            "2I 2I": 32,
            "2K 2K": -3,
            "2L 2L": -3,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/4": {
        "num": 3,
        "name": "H4/4",
        "factor": 1 / (56 * math.sqrt(15015)),
        "elements": {
            "4S 4S": 0,
            "4D 4D": -8008,
            "4F 4F": 0,
            "4G 4G": 7280,
            "4I 4I": -1960,
            "2P 2P": 0,
            "2D1 2D1": -1144,
            "2D1 2D2": 468 * math.sqrt(33),
            "2D2 2D2": 3237,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": 1365,
            "2G1 2G1": 1040,
            "2G1 2G2": -24 * math.sqrt(4290),
            "2G2 2G2": -2475,
            "2H1 2H1": 0,
            "2H1 2H2": 84 * math.sqrt(455),
            "2H2 2H2": -1995,
            "2I 2I": -280,
            "2K 2K": 1827,
            "2L 2L": -525,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/5": {
        "num": 3,
        "name": "H4/5",
        "factor": 3 / (49 * math.sqrt(17160)),
        "elements": {
            "4S 4S": 0,
            "4D 4D": 0,
            "4F 4F": 0,
            "4G 4G": 0,
            "4I 4I": 0,
            "2P 2P": 0,
            "2D1 2D1": 286,
            "2D1 2D2": 156 * math.sqrt(33),
            "2D2 2D2": -377,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": -455,
            "2G1 2G1": -260,
            "2G1 2G2": -8 * math.sqrt(4290),
            "2G2 2G2": 561,
            "2H1 2H1": 0,
            "2H1 2H2": -28 * math.sqrt(455),
            "2H2 2H2": -49,
            "2I 2I": 70,
            "2K 2K": 315,
            "2L 2L": -245,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/6": {
        "num": 3,
        "name": "H4/6",
        "factor": 1 / (924 * math.sqrt(455)),
        "elements": {
            "4S 4S": 0,
            "4D 4D": 0,
            "4F 4F": 0,
            "4G 4G": 0,
            "4I 4I": 0,
            "2P 2P": -30030,
            "2D1 2D1": 12870,
            "2D1 2D2": -624 * math.sqrt(33),
            "2D2 2D2": -1677,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": 1365,
            "2G1 2G1": 4680,
            "2G1 2G2": -52 * math.sqrt(4290),
            "2G2 2G2": 1221,
            "2H1 2H1": 8190,
            "2H1 2H2": 0,
            "2H2 2H2": -2709,
            "2I 2I": -8190,
            "2K 2K": -252,
            "2L 2L": 1260,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/7": {
        "num": 3,
        "name": "H4/7",
        "factor": 1 / (168 * math.sqrt(5005)),
        "elements": {
            "4S 4S": 0,
            "4D 4D": 0,
            "4F 4F": 0,
            "4G 4G": 0,
            "4I 4I": 0,
            "2P 2P": 0,
            "2D1 2D1": 10296,
            "2D1 2D2": 156 * math.sqrt(33),
            "2D2 2D2": -1833,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": -1365,
            "2G1 2G1": -9360,
            "2G1 2G2": -8 * math.sqrt(4290),
            "2G2 2G2": 1947,
            "2H1 2H1": 0,
            "2H1 2H2": 252 * math.sqrt(455),
            "2H2 2H2": 567,
            "2I 2I": 2520,
            "2K 2K": 21,
            "2L 2L": -315,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/8": {
        "num": 3,
        "name": "H4/8",
        "factor": 1 / math.sqrt(16336320),
        "elements": {
            "4S 4S": 0,
            "4D 4D": 0,
            "4F 4F": 0,
            "4G 4G": 0,
            "4I 4I": 0,
            "2P 2P": 0,
            "2D1 2D1": 0,
            "2D1 2D2": 0,
            "2D2 2D2": 4641,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": -3315,
            "2G1 2G1": 0,
            "2G1 2G2": 0,
            "2G2 2G2": 1309,
            "2H1 2H1": 0,
            "2H1 2H2": 0,
            "2H2 2H2": -1071,
            "2I 2I": 0,
            "2K 2K": -1071,
            "2L 2L": 945,
        },
        "source": "[34]",
        "table": "VIII",
    },
    "Nd3+|H4/9": {
        "num": 3,
        "name": "H4/9",
        "factor": 1,
        "elements": {
            "4S 4S": 0,
            "4D 4D": 0,
            "4F 4F": 0,
            "4G 4G": 0,
            "4I 4I": 0,
            "2P 2P": 0,
            "2D1 2D1": 0,
            "2D1 2D2": 0,
            "2D2 2D2": 0,
            "2F1 2F1": 0,
            "2F1 2F2": 0,
            "2F2 2F2": 0,
            "2G1 2G1": 0,
            "2G1 2G2": 0,
            "2G2 2G2": 0,
            "2H1 2H1": 0,
            "2H1 2H2": 0,
            "2H2 2H2": 0,
            "2I 2I": 0,
            "2K 2K": 0,
            "2L 2L": 0,
        },
        "source": "[34]",
        "table": "VIII",
    },
}
