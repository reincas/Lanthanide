import numpy as np

from lanthanide import Lanthanide, Coupling

RADIAL = {
    "Pr3+:ML": {
        "num": 2,
        "radial": {
            "base": -1, "E^1": 4548.2, "E^2": 21.937, "E^3": 466.73,
            "H2": 740.75, "H3/0": 21.255, "H3/1": -799.94, "H3/2": 1342.9,
            "Hcf/2,0": -120, "Hcf/2,2": -98,
            "Hcf/4,0": 644, "Hcf/4,2": 375+123j, "Hcf/4,4": 483+343j,
            "Hcf/6,0": 503, "Hcf/6,2": -1000+78j, "Hcf/6,4": -131-509j, "Hcf/6,6": -381-608j
        },
    },
    "Pr3+:LaF3": {
        "num": 2,
        "radial": {
            "base": 0.2, "H1/2": 68878, "H1/4": 50347, "H1/6": 32901,
            "H2": 751.7, "H3/0": 16.23, "H3/1": -566.6, "H3/2": 1371,
            "H5/0": 2.08, "H5/2": 2.08 * 0.56, "H5/4": 2.08 * 0.31,
            "H6/2": -88.6, "H6/4": -88.6 * 0.5, "H6/6": -88.6 * 0.1,
            "Hcf/2,0": -218, "Hcf/4,0": 738, "Hcf/6,0": 679, "Hcf/2,2": -120, "Hcf/4,2": 431, "Hcf/4,4": 616,
            "Hcf/6,2": -921, "Hcf/6,4": -348, "Hcf/6,6": -788
        },
    },
    "Nd3+:LaF3": {
        "num": 3,
        "radial": {
            "base": 5, "H1/2": 73018, "H1/4": 52789, "H1/6": 35757,
            "H2": 885.3, "H3/0": 21.34, "H3/1": -593.0, "H3/2": 1445,
            "H4/2": 298, "H4/3": 35, "H4/4": 59, "H4/6": -285, "H4/7": 332, "H4/8": 305,
            "H5/0": 2.11, "H5/2": 2.11 * 0.56, "H5/4": 2.11 * 0.31,
            "H6/2": 192, "H6/4": 192 * 0.5, "H6/6": 192 * 0.1,
            "Hcf/2,0": -256, "Hcf/4,0": 496, "Hcf/6,0": 641, "Hcf/2,2": -48, "Hcf/4,2": 521, "Hcf/4,4": 563,
            "Hcf/6,2": -839, "Hcf/6,4": -408, "Hcf/6,6": -831
        },
    },
    "Tm3+:LaF3": {
        "num": 12,
        "radial": {
            "base": -4, "H1/2": 100134, "H1/4": 69613, "H1/6": 55975,
            "H2": 2636, "H3/0": 17.26, "H3/1": -624.5, "H3/2": 1820,
            "H5/0": 3.81, "H5/2": 3.81 * 0.56, "H5/4": 3.81 * 0.31,
            "H6/2": 695, "H6/4": 695 * 0.5, "H6/6": 695 * 0.1,
            "Hcf/2,0": -249, "Hcf/4,0": 457, "Hcf/6,0": 282, "Hcf/2,2": -105, "Hcf/4,2": 320, "Hcf/4,4": 428,
            "Hcf/6,2": -482, "Hcf/6,4": -234, "Hcf/6,6": -492
        },
    },
}
coupling = Coupling.SLJM

data = RADIAL["Pr3+:LaF3"]
num = data["num"]
radial = data["radial"]

with Lanthanide(num, radial=radial, coupling=coupling) as ion:
    for state in ion.intermediate:
        state_str = f"| {state.long(min_weight=0.01)} >"
        print(f"{state.energy:6.0f} cm-1 {state_str}")
